#ifndef INCLUDE_DM_SPECTRUM_H_
#define INCLUDE_DM_SPECTRUM_H_

#include <string>
#include <vector>

#include "cgs.h"

enum class dmChannel {
	e = 2,
	mu = 5,
	tau = 8,
	q = 9,
	c = 10,
	b = 11,
	t = 12,
	W = 15,
	Z = 18,
	h = 21
};

enum class dmMass {
	m5GeV = 5,
	m6GeV = 6,
	m8GeV = 8,
	m10GeV = 10,
	m15GeV = 15,
	m20GeV = 20,
	m25GeV = 25,
	m30GeV = 30,
	m40GeV = 40,
	m50GeV = 50,
	m60GeV = 60,
	m70GeV = 70,
	m80GeV = 80,
	m90GeV = 90,
	m100GeV = 100,
	m110GeV = 110,
	m120GeV = 120,
	m130GeV = 130,
	m140GeV = 140,
	m150GeV = 150,
	m160GeV = 160,
	m180GeV = 180,
	m200GeV = 200,
	m220GeV = 220,
	m240GeV = 240,
	m260GeV = 260,
	m280GeV = 280,
	m300GeV = 300,
	m330GeV = 330,
	m360GeV = 360,
	m400GeV = 400,
	m450GeV = 450,
	m500GeV = 500,
	m550GeV = 550,
	m600GeV = 600,
	m650GeV = 650,
	m700GeV = 700,
	m750GeV = 750,
	m800GeV = 800,
	m900GeV = 900,
	m1TeV = 1000,
	m1100GeV = 1100,
	m1200GeV = 1200,
	m1300GeV = 1300,
	m1500GeV = 1500,
	m1700GeV = 1700,
	m2TeV = 2000,
	m3TeV = 3000,
	m4TeV = 4000,
	m5TeV = 5000,
	m6TeV = 6000,
	m7TeV = 7000,
	m8TeV = 8000,
	m9TeV = 9000,
	m10TeV = 10000,
	m12TeV = 12000,
	m15TeV = 15000,
	m20TeV = 20000,
	m30TeV = 30000,
	m50TeV = 50000,
	m100TeV = 100000
};

class DM_Spectrum {
protected:
	//const std::vector<Channel> DM_channels = { e, tau, q, c, b, t, W, Z, h };
	const std::string m_filename = "AtProduction_gammas.txt";
	dmChannel m_channel;
	dmMass m_mass;
	std::vector<std::pair<double, double> > spectrum;

protected:
	void load_table(size_t icol);

public:
	DM_Spectrum(dmChannel channel, dmMass mass) :
			m_channel(channel), m_mass(mass) {
		load_table((int) m_channel);
	}

	~DM_Spectrum() = default;

	double get(const double E_gamma) const;

	const double mass_c2() const {
		return (int) m_mass * cgs::GeV;
	}
};

#endif
